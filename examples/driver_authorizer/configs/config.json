{
  "config_vars": "/etc/yandex/taxi/driver-authorizer/config_vars.json",
  "server": {
    "listener": {
      "connection": {
        "task_processor": "main-task-processor",
        "in_buf_size": 4096,
        "requests_queue_size_threshold": 100
      },
      "port": "$server_port",
      "port#fallback": 1180,
      "monitor_port": "$server_monitor_port",
      "monitor_port#fallback": 1188
    },
    "logger_access": "access",
    "logger_access_tskv": "access-tskv",
    "coro_pool": {
      "initial_size": 5000,
      "max_size": 50000
    },
    "schedulers": [
      {
        "name": "main-scheduler",
        "threads": 1,
        "thread_name": "scheduler"
      }
    ],
    "task_processors": [
      {
        "name": "main-task-processor",
        "worker_threads": "$main_worker_threads",
        "worker_threads#fallback": 8,
        "thread_name": "Main worker thread",
        "scheduler": "main-scheduler"
      },
      {
        "name": "mongo-task-processor",
        "worker_threads": "$mongo_worker_threads",
        "worker_threads#fallback": 5,
        "thread_name": "Mongo worker thread",
        "scheduler": "main-scheduler"
      }
    ],
    "default_task_processor": "main-task-processor",
    "components": [
      {
        "name": "logging",
        "loggers": {
          "default": {
            "file_path": "/var/log/yandex/taxi-driver-authorizer/server.log",
            "level": "$logger_level",
            "level#fallback": "info",
            "overflow_behavior": "block"
          },
          "access": {
            "file_path": "/var/log/yandex/taxi-driver-authorizer/access.log",
            "pattern": "[%Y-%m-%d %H:%M:%S.%f %z] %v"
          },
          "access-tskv": {
            "file_path": "/var/log/yandex/taxi-driver-authorizer/access_tskv.log",
            "pattern": "tskv\ttskv_format=taxi_driver_authorizer\ttimestamp=%Y-%m-%dT%H:%M:%S\ttimezone=%z%v"
          }
        }
      },
      {
        "name": "io-thread-pool",
        "thread_name": "i/o thread",
        "threads": "$io_threads",
        "threads#fallback": 2
      },
      {
        "name": "redis-sentinel-thread-pool",
        "thread_name": "sentinels",
        "threads": 1
      },
      {
        "name": "redis-thread-pool",
        "thread_name": "Redis thread",
        "threads": "$redis_threads",
        "threads#fallback": 4
      },
      {
        "name": "secdist",
        "config": "/etc/yandex/taxi-secdist/taxi.json"
      },
      {
        "name": "redis",
        "thread_pool": "redis-thread-pool",
        "sentinel_thread_pool": "redis-sentinel-thread-pool",
        "task_processor": "main-task-processor",
        "groups": [
          {
            "db": "taximeter-base",
            "config_name": "$redis_taximeter_base",
            "config_name#fallback": "taximeter-base"
          }
        ]
      },
      {
        "name": "mongo-taxi",
        "task_processor": "mongo-task-processor",
        "dbalias": "taxi"
      },
      {
        "name": "taxi-config",
        "interval_ms": 5000,
        "clean_interval_ms": 60000,
        "fallback_path": "$taxi_config_fallback_path",
        "fallback_path#fallback": "/etc/yandex/taxi/driver-authorizer/taxi_config_fallback.production.json"
      },
      {
        "name": "handler-ping",
        "path": "/ping",
        "task_processor": "main-task-processor"
      },
      {
        "name": "handler-driver-session",
        "path": "/driver_session",
        "task_processor": "main-task-processor",
        "session_ttl_update_enabled": "$session_ttl_update_enabled",
        "session_ttl_update_enabled#fallback": false
      }
    ]
  }
}
